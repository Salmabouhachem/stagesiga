<div class="admin-dashboard">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="logo">Admin Panel</div>
<nav>
  <ul>
    <li (click)="changeView('dashboard')">Dashboard</li>
    <li (click)="changeView('demandes')">Demandes</li>
    <li (click)="changeView('devis')">Devis</li>
    <li (click)="changeView('users')">Utilisateurs</li>
    <li (click)="changeView('centres')">Centres</li>
    <li (click)="logout()">Déconnexion</li>
  </ul>
</nav>

  </div>

  <!-- Main Content -->
  <div class="main-content">
    <div *ngIf="currentView === 'dashboard'" class="dashboard-view">
      <h2>Bonjour, {{ adminName }}</h2>
      <div class="status-grid">
        <div class="status-card">
          <h3>Demandes actives</h3>
          <p>{{ todayRequests }}</p>
          <span>Aucune demande active</span>
        </div>
        <div class="status-card">
          <h3>Devis en attente</h3>
          <p>{{ pendingQuotes }}</p>
          <span>Aucun devis en attente</span>
        </div>
        <div class="status-card">
          <h3>Demandes terminées</h3>
          <p>{{ completedDemandes }}</p>
          <span>Aucune demande terminée</span>
        </div>
      </div>
      <div class="recent-requests">
        <h3>Mes dernières demandes</h3>
        <p *ngIf="requests.length === 0">Vous n'avez aucune demande</p>
        <ul>
          <li *ngFor="let request of requests.slice(0, 5)">
            {{ request.client }} - {{ request.date }} ({{ request.status }})
          </li>
        </ul>
      </div>
    </div>

    <div *ngIf="currentView === 'stats'" class="stats-view">
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Centres</h3>
          <p>{{ stats.totalCentres || 0 }}</p>
        </div>
        <div class="stat-card">
          <h3>Utilisateurs</h3>
          <p>{{ stats.totalUsers || 0 }}</p>
        </div>
        <div class="stat-card">
          <h3>Demandes</h3>
          <p>{{ stats.totalDemandes || 0 }}</p>
        </div>
      </div>
    </div>

    <div *ngIf="currentView === 'centres'" class="centres-view">
      <app-centres-list [centres]="centres"></app-centres-list>
    </div>

    <div *ngIf="currentView === 'users'" class="users-view">
      <app-users-list [users]="users"></app-users-list>
    </div>
    <!-- Section Demandes -->
<!-- Table des demandes -->
<section *ngIf="currentView === 'demandes'" class="admin-content">
  <h2>Toutes les demandes</h2>
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Référence</th>
          <th>Client</th>
          <th>Date</th>
          <th>Statut</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let demande of demandes">
          <td>#{{ demande.id }}</td>
          <td>{{ demande.nom }} {{ demande.prenom }}</td>
          <td>{{ demande.date | date:'dd/MM/yyyy' }}</td>
          <td>
            <span class="status-badge" [ngClass]="demande.status">{{ demande.status }}</span>
          </td>
          <td>
            <button class="btn-action" (click)="selectDemande(demande)">Voir</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Fiche détails -->
  <div *ngIf="selectedDemande" class="details-card">
    <h3>Détails de la demande #{{ selectedDemande.id }}</h3>
    <p><strong>Client:</strong> {{ selectedDemande.nom }} {{ selectedDemande.prenom }}</p>
    <p><strong>Email:</strong> {{ selectedDemande.email }}</p>
    <p><strong>Téléphone:</strong> {{ selectedDemande.telephone }}</p>
    <p><strong>Adresse:</strong> {{ selectedDemande.adresse }}</p>
    <p><strong>Description:</strong> {{ selectedDemande.description }}</p>
    <button class="btn-close" (click)="selectedDemande = null">Fermer</button>
  </div>
</section>


<!-- Section Devis -->
<section *ngIf="currentView === 'devis'" class="admin-content">
  <h2>Tous les devis</h2>
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Réf</th>
          <th>Client</th>
          <th>Montant</th>
          <th>Date</th>
          <th>Statut</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let quote of quotes">
          <td>#{{ quote.id }}</td>
          <td>{{ quote.clientName || quote.client }}</td>
          <td>{{ quote.amount | currency:'EUR':'symbol':'1.2-2' }}</td>
          <td>{{ quote.date | date:'dd/MM/yyyy' }}</td>
          <td>
            <span class="status-badge" [ngClass]="quote.status">
              {{ quote.status }}
            </span>
          </td>
          <td>
            <button class="btn-action" (click)="viewQuote(quote)">
              Voir
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Fiche détails -->
  <div *ngIf="selectedQuote" class="details-card">
    <h3>Détails du devis #{{ selectedQuote.id }}</h3>

    <p><strong>Client:</strong> {{ selectedQuote.clientName || selectedQuote.client }}</p>
    <p><strong>Date:</strong> {{ selectedQuote.date | date:'dd/MM/yyyy' }}</p>
    <p><strong>Montant:</strong> {{ selectedQuote.amount | currency:'EUR':'symbol':'1.2-2' }}</p>
    <p><strong>Statut:</strong> {{ selectedQuote.status }}</p>
    <p><strong>Description:</strong> {{ selectedQuote.description || 'Aucune description' }}</p>

    <button class="btn-close" (click)="closeQuoteDetails()">Fermer</button>
  </div>
</section>
